<%@ Page Title="" Language="C#" MasterPageFile="~/MasterPage/MasterPage.master" AutoEventWireup="true"
    CodeFile="SAL3101_02.aspx.cs" Inherits="SAL_SAL3_VBOld_SAL3101_02" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
    <script>
        function IsFloatText() {
            var charkc = window.event.keyCode
            if (charkc == 46 || (charkc >= 48 && charkc <= 57)) {
                return true;
            }
            return false;
        }
        </script>
    <table class="tableStyle99" width="100%">
            <tr>
            <td class="htmltable_Title" colspan="7">
                員工列印排序設定
            </td>
        </tr>
        <tr>
            <td class="htmltable_Title">
                順序一
                <asp:DropDownList ID="DropDownList_order1" runat="server">
                    <asp:ListItem Value="base_prts" Selected="true">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序二
                <asp:DropDownList ID="DropDownList_order2" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job" Selected="true">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序三
                <asp:DropDownList ID="DropDownList_order3" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono" Selected="true">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序四
                <asp:DropDownList ID="DropDownList_order4" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep" Selected="true">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序五
                <asp:DropDownList ID="DropDownList_order5" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3" Selected="true">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序六
                <asp:DropDownList ID="DropDownList_order6" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1" Selected="true">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
            <td class="htmltable_Title">
                順序七
                <asp:DropDownList ID="DropDownList_order7" runat="server">
                    <asp:ListItem Value="base_prts">列印順序</asp:ListItem>
                    <asp:ListItem Value="base_job">職業類別</asp:ListItem>
                    <asp:ListItem Value="base_prono">工作計畫</asp:ListItem>
                    <asp:ListItem Value="base_dep">科室</asp:ListItem>
                    <asp:ListItem Value="base_org_l3">官等</asp:ListItem>
                    <asp:ListItem Value="base_org_l1">職等</asp:ListItem>
                    <asp:ListItem Value="base_ptb" Selected="true">俸點</asp:ListItem>
                    <asp:ListItem Value="base_idno">身份證字號</asp:ListItem>
                    <asp:ListItem Value="disable">=不設定=</asp:ListItem>
                </asp:DropDownList>
            </td>
        </tr>
    </table>
        <table class="tableStyle99" width="100%">
        <tr><td>
    <asp:GridView ID="GridView_SaBase" runat="server" 
                AutoGenerateColumns="False" 
                AllowPaging="True" 
                CssClass="Grid" CellPadding="1" CellSpacing="1" BorderWidth="0px" 
                Width="100%" PageSize="30" 
                onpageindexchanged="GridView_SaBase_PageIndexChanged" 
                onpageindexchanging="GridView_SaBase_PageIndexChanging">
                    <PagerSettings />
                    <Columns>
                        <asp:TemplateField HeaderText="員工姓名">
                            <ItemTemplate>
                                <asp:Label ID="Label_name" runat="server" Text='<%# Eval("base_name") %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="職業類別">
                            <ItemTemplate>
                                <asp:Label ID="Label_job" runat="server" Text='<%# Eval("base_job_name") %>' style='<%# FStyle(Eval("base_job_name")) %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="職稱">
                            <ItemTemplate>
                                <asp:Label ID="Label_dcode_name" runat="server" Text='<%# Eval("base_dcode_name") %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="官等">
                            <ItemTemplate>
                                <asp:Label ID="Label_org_l3" runat="server" Text='<%# Eval("base_org_l3_name") %>' style='<%# FStyle(Eval("base_org_l3_name")) %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="職等">
                            <ItemTemplate>
                                <asp:Label ID="Label_org_l1" runat="server" Text='<%# Eval("base_org_l1_name") %>' style='<%# FStyle(Eval("base_org_l1_name")) %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="俸點">
                            <ItemTemplate>
                                <asp:Label ID="Label_ptb" runat="server" Text='<%# Eval("base_ptb") %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="身分證字號">
                            <ItemTemplate>
                                <asp:Label ID="Label_idno" runat="server" Text='<%# Eval("base_idno") %>'></asp:Label>
                            </ItemTemplate>

                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="列印順序">
                            <ItemTemplate>
                                <asp:TextBox ID="TextBox_base_seqno" runat="server" Text='<%# Eval("base_seqno") %>' Visible="false"></asp:TextBox>
                                <asp:TextBox ID="TextBox_base_prts" runat="server" Text='<%# Eval("base_prts") %>' Width="80" MaxLength="10"  onkeypress="return IsFloatText();"></asp:TextBox>
                                <asp:TextBox ID="TextBox_base_prts_Ori" Visible="false" runat="server" Text='<%# Eval("base_prts") %>' Width="80" MaxLength="10"></asp:TextBox>
                            </ItemTemplate>

                        </asp:TemplateField>
                    </Columns>
            <RowStyle CssClass="Row" />
            <AlternatingRowStyle CssClass="AlternatingRow" />
            <PagerSettings Position="TopAndBottom" />
            <EmptyDataRowStyle ForeColor="Red" HorizontalAlign="Center" />
                    <EmptyDataTemplate>
                        <table class="table_1">
                            <tr align="center" class="list_tr">
                                <td class="col_1" colspan="6">
                                    目前無任何資料!!
                                </td>
                            </tr>
                        </table>
                    </EmptyDataTemplate>
                </asp:GridView>
                
                </td></tr>
                <tr><td align="right"><uc1:Ucpager ID="Ucpager1" runat="server" 
                        GridName="GridView_SaBase" PNow="1" PSize="30" /></td></tr>
                
                </table>

                <table class="tableStyle99" width="100%">
                    <tr>
                        <td class="htmltable_Bottom">
                            <asp:Button ID="Button_Update" runat="server" Text="儲存順序設定" 
                                onclick="Button_Update_Click"/>
                            <asp:Button ID="Button_SortReset" runat="server" Text="系統重設列印順序(批次儲存)" 
               OnClientClick="confirm('[系統重設列印順序]\n\n此功能將依照下列清單之列印順序重新給號並儲存。\n\n執行之後不可回復！！是否確定執行？');" 
                                onclick="Button_SortReset_Click" />
                                <asp:Button ID="btnClose" runat="server" Text="關閉" 
                                onclick="btnClose_Click" />
                        </td>
                    </tr>
                </table>    
</asp:Content>
